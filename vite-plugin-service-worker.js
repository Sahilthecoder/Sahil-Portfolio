import { writeFileSync } from 'fs';
import { join } from 'path';

export default function serviceWorkerPlugin() {
  return {
    name: 'service-worker',
    writeBundle() {
      // This will run after the build is complete
      const swPath = join(__dirname, 'dist/sw.js');
      const swContent = `
        // Auto-generated by Vite plugin
        importScripts('/sw.js');
      `;
      
      // Write the service worker file
      writeFileSync(swPath, swContent.trim());
      console.log('Service worker generated at:', swPath);
    }
  };
}
